<h1>Staff Records</h1>
<table>
    <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Unique Code</th>
        <th>Role</th>
        <th>Actions</th> <!-- New column for actions -->
    </tr>
    {{#each staff}}
    <tr data-id="{{this._id}}">
        <td>{{this.name}}</td>
        <td>{{this.email}}</td>
        <td>{{this.uniqueCode}}</td>
        <td>{{this.role}}</td>
        <td>
            <button class="delete-btn" data-id="{{this._id}}">Delete</button>
        </td>
    </tr>
    {{/each}}
</table>

<script>
document.querySelectorAll('.delete-btn').forEach(button => {
    button.addEventListener('click', function() {
        const staffId = this.getAttribute('data-id');

        if (confirm("Are you sure you want to delete this staff record?")) {
            fetch(`/api/staff/${staffId}`, {
                method: 'DELETE',
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Remove the deleted entry from the DOM
                    const row = this.closest('tr');
                    row.remove();
                } else {
                    alert(data.message || 'Failed to delete the staff record');
                }
            })
            .catch(error => console.error('Error:', error));
        }
    });
});
</script>